<!doctype html>
<html>
<head data-cast-api-enabled="true">
  <meta charset="utf-8">
  <title>videojs-externals Demo</title>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        rel="stylesheet">
  <link href="node_modules/video.js/dist/video-js.css" rel="stylesheet">
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.3/angular.min.js">
  </script>
  <script
    src="//cdn.rawgit.com/angular-ui/bootstrap/gh-pages/ui-bootstrap-tpls-2.5.0.min.js">
  </script>
  <script
    src="//cdn.rawgit.com/angular-ui/bootstrap/gh-pages/ui-bootstrap-2.5.0.min.js">
  </script>
  <script src="node_modules/video.js/dist/video.js"></script>
  <script src="dist/videojs-externals.js"></script>
  <script>
    function DemoController($scope) {

      $scope.sources = [
        {
          tech: "Dailymotion"
          ,
          source: "http://www.dailymotion.com/video/x56imdz_une-pluie-d-hommages-pour-le-chanteur-george-michael-sur-les-reseaux-sociaux_news"
        },
        {
          tech: "Deezer"
          , source: "http://www.deezer.com/track/1167893"
        },
        {
          tech: "Soundcloud"
          ,
          source: "https://soundcloud.com/yozzie-b/rhiana-where-have-u-been-ukg"
        },
        {
          tech: "Vimeo"
          , source: "https://vimeo.com/210321457"
        },
        {
          tech: "Youtube"
          , source: "https://www.youtube.com/watch?v=DIDp05SHJVk"
        }
      ]

      $scope.selected = {
        "source": null
      }

      $scope.load = function () {
        if (!$scope.selected.source) {
          return
        }
        var container = document.getElementById('video-container');

        function createInstance() {
          var video = document.createElement('video');
          video.id = 'player';
          video.className = 'video-js vjs-fluid vjs-default-skin';
          video.crossOrigin = true;
          video.setAttribute('crossorigin', true);
          container.appendChild(video);

          var player = videojs('player', {
            controls: true,
            autoplay: 0,
            width: 250,
            techOrder: [
              , 'dailymotion'
              , 'deezer'
              , 'html5'
              , 'soundcloud'
              , 'spotify'
              , 'vimeo'
              , 'youtube'
            ],
            sources: [{src: $scope.selected.source}]
          }).on('loadedmetadata', function (e) {
            //      alert(e.message);
          });
        }


        // init instance

        if (document.getElementById("player")) {
          var player = videojs('player');
          player.one('dispose', function () {

            container.removeChild(container.firstChild);
            setTimeout(() => {
              createInstance();
            }, 10)
          });
          return player.dispose();
        } else {
          createInstance()
        }
      }
    }
    angular.module("demoApp", ["ui.bootstrap"])
      .controller("DemoController", DemoController);


  </script>
</head>
<body ng-app="demoApp">

<div ng-controller="DemoController">
  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">Source:</h3>
    </div>
    <div class="panel-body btn-group" role="group">
      <button
        class="btn btn-default"
        ng-repeat="source in sources"
        ng-click="selected.source = source.source"
      >
        {{ source.tech }}
      </button>
    </div>
    <div class="form-group">
      <input type="text" class="form-control" ng-model="selected.source">
    </div>
    <div class="form-group">
      <button class="btn btn-primary" ng-click="load()">
        Load source
      </button>
    </div>
  </div>
</div>

<div id="video-container">
</div>

</body>
</html>
